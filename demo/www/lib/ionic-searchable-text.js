!function(t,e){var n=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=e);else try{n.innerHTML=e}catch(o){n.innerText=e}}(document,".searchable-text-found {\n  border: 1px solid red;\n  color: green;\n  border-radius: 3px;\n}\n\n.searchable-text-focus{\n  background-color: yellow;\n}\n\n.searchable-text-button-next{\n  position: fixed;\n  top: 0px;\n  right: 0;\n}\n\n\n.searchable-text-button-search-nav{\n    position: relative !important;\n    top: 0 !important;\n    bottom:0 !important;\n    color: #fff !important;\n}"),angular.module("searchable-text",[]).directive("searchableText",["$timeout","$ionicScrollDelegate",function(t,e){return{scope:{original:"@text",showInput:"=",input:"=",next:"&"},template:['<div class="bar bar-header item-input-inset" ng-show="showInput">','<button class="button button-clear"  style="position: absolute; top: 5px; right: 100px; " ng-click="clear()">&#x2715;</button>','<label class="item-input-wrapper" style="position: relative;">','<i class="icon ion-ios-search placeholder-icon"></i>','<input type="search" placeholder="Search" ng-model="input" id="input-search">','<p style=" position: absolute; display: inline; right: 39px; top: 7px; color: #b2b2b2; ">{{ result }}</p>',"</label>",'<div><button class="button button-clear button-search-nav" ng-click="previous()" style="margin-left:5px">Prev</button><button class="button button-clear button-search-nav" ng-click="next()">Next</button></div>',"</div>",'<div ng-bind-html="text | to_trusted" class="book-text"  id="content"></div>'].join(""),link:function(e,n,o){var r=e.original;e.text=r;var a=function(){e.input=""};e.clear=a,e.$watch("showInput",function(){a()},!0);var l=function(){var t=$("#content"),e=$(".searchable-text-focus");t.animate({scrollTop:e.offset().top-t.offset().top+t.scrollTop()-88})},c=function(t){e.result=t},s=function(t,n){return function(){e.input&&($(".searchable-text-found").removeClass("searchable-text-focus"),console.log("counter","isNext=",n,t),n?t.current<t.total-1?t.current++:t.current=0:t.current>0?t.current--:t.current=t.total-1,$(".searchable-text-found").eq(t.current).addClass("searchable-text-focus"),l(),c(t.current+1+" of "+t.total))}};e.$watch("input",function(n,o){if(n!==o){if(n.length<1)return e.text=r,void c("");var a=new RegExp("("+n+")","gi");a.test(r)?(e.text=r,e.text=e.text.replace(a,"<span class='searchable-text-found'>$1</span>"),t(function(){$(".searchable-text-found").eq(0).addClass("searchable-text-focus");var t={current:0,total:$(".searchable-text-found").length};e.next=s(t,!0),e.previous=s(t,!1),c("1 of "+t.total),l()},10)):(e.text=r,c("No match"))}})}}}]).filter("to_trusted",["$sce",function(t){return function(e){return t.trustAsHtml(e)}}]);
